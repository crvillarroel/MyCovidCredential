var ln=Object.defineProperty;var on=(e,i,t)=>i in e?ln(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var Ne=(e,i,t)=>(on(e,typeof i!="symbol"?i+"":i,t),t);/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const fn=4,Ut=0,Ot=1,sn=2;function ce(e){let i=e.length;for(;--i>=0;)e[i]=0}const cn=0,Ct=1,_n=2,hn=3,dn=258,Qe=29,be=256,xe=be+1+Qe,_e=30,et=19,Nt=2*xe+1,ae=15,tt=16,un=7,it=256,Zt=16,Lt=17,Mt=18,nt=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ze=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),gn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ft=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wn=512,Y=new Array((xe+2)*2);ce(Y);const pe=new Array(_e*2);ce(pe);const ve=new Array(wn);ce(ve);const ke=new Array(dn-hn+1);ce(ke);const at=new Array(Qe);ce(at);const Le=new Array(_e);ce(Le);function rt(e,i,t,a,n){this.static_tree=e,this.extra_bits=i,this.extra_base=t,this.elems=a,this.max_length=n,this.has_stree=e&&e.length}let $t,Ht,Bt;function lt(e,i){this.dyn_tree=e,this.max_code=0,this.stat_desc=i}const Pt=e=>e<256?ve[e]:ve[256+(e>>>7)],Ee=(e,i)=>{e.pending_buf[e.pending++]=i&255,e.pending_buf[e.pending++]=i>>>8&255},L=(e,i,t)=>{e.bi_valid>tt-t?(e.bi_buf|=i<<e.bi_valid&65535,Ee(e,e.bi_buf),e.bi_buf=i>>tt-e.bi_valid,e.bi_valid+=t-tt):(e.bi_buf|=i<<e.bi_valid&65535,e.bi_valid+=t)},K=(e,i,t)=>{L(e,t[i*2],t[i*2+1])},Kt=(e,i)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--i>0);return t>>>1},bn=e=>{e.bi_valid===16?(Ee(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},xn=(e,i)=>{const t=i.dyn_tree,a=i.max_code,n=i.stat_desc.static_tree,r=i.stat_desc.has_stree,f=i.stat_desc.extra_bits,o=i.stat_desc.extra_base,g=i.stat_desc.max_length;let l,s,m,w,c,k,h=0;for(w=0;w<=ae;w++)e.bl_count[w]=0;for(t[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<Nt;l++)s=e.heap[l],w=t[t[s*2+1]*2+1]+1,w>g&&(w=g,h++),t[s*2+1]=w,!(s>a)&&(e.bl_count[w]++,c=0,s>=o&&(c=f[s-o]),k=t[s*2],e.opt_len+=k*(w+c),r&&(e.static_len+=k*(n[s*2+1]+c)));if(h!==0){do{for(w=g-1;e.bl_count[w]===0;)w--;e.bl_count[w]--,e.bl_count[w+1]+=2,e.bl_count[g]--,h-=2}while(h>0);for(w=g;w!==0;w--)for(s=e.bl_count[w];s!==0;)m=e.heap[--l],!(m>a)&&(t[m*2+1]!==w&&(e.opt_len+=(w-t[m*2+1])*t[m*2],t[m*2+1]=w),s--)}},Wt=(e,i,t)=>{const a=new Array(ae+1);let n=0,r,f;for(r=1;r<=ae;r++)a[r]=n=n+t[r-1]<<1;for(f=0;f<=i;f++){let o=e[f*2+1];o!==0&&(e[f*2]=Kt(a[o]++,o))}},pn=()=>{let e,i,t,a,n;const r=new Array(ae+1);for(t=0,a=0;a<Qe-1;a++)for(at[a]=t,e=0;e<1<<nt[a];e++)ke[t++]=a;for(ke[t-1]=a,n=0,a=0;a<16;a++)for(Le[a]=n,e=0;e<1<<Ze[a];e++)ve[n++]=a;for(n>>=7;a<_e;a++)for(Le[a]=n<<7,e=0;e<1<<Ze[a]-7;e++)ve[256+n++]=a;for(i=0;i<=ae;i++)r[i]=0;for(e=0;e<=143;)Y[e*2+1]=8,e++,r[8]++;for(;e<=255;)Y[e*2+1]=9,e++,r[9]++;for(;e<=279;)Y[e*2+1]=7,e++,r[7]++;for(;e<=287;)Y[e*2+1]=8,e++,r[8]++;for(Wt(Y,xe+1,r),e=0;e<_e;e++)pe[e*2+1]=5,pe[e*2]=Kt(e,5);$t=new rt(Y,nt,be+1,xe,ae),Ht=new rt(pe,Ze,0,_e,ae),Bt=new rt(new Array(0),gn,0,et,un)},Gt=e=>{let i;for(i=0;i<xe;i++)e.dyn_ltree[i*2]=0;for(i=0;i<_e;i++)e.dyn_dtree[i*2]=0;for(i=0;i<et;i++)e.bl_tree[i*2]=0;e.dyn_ltree[it*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Vt=e=>{e.bi_valid>8?Ee(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},vn=(e,i,t,a)=>{Vt(e),a&&(Ee(e,t),Ee(e,~t)),e.pending_buf.set(e.window.subarray(i,i+t),e.pending),e.pending+=t},Yt=(e,i,t,a)=>{const n=i*2,r=t*2;return e[n]<e[r]||e[n]===e[r]&&a[i]<=a[t]},ot=(e,i,t)=>{const a=e.heap[t];let n=t<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Yt(i,e.heap[n+1],e.heap[n],e.depth)&&n++,!Yt(i,a,e.heap[n],e.depth));)e.heap[t]=e.heap[n],t=n,n<<=1;e.heap[t]=a},Xt=(e,i,t)=>{let a,n,r=0,f,o;if(e.last_lit!==0)do a=e.pending_buf[e.d_buf+r*2]<<8|e.pending_buf[e.d_buf+r*2+1],n=e.pending_buf[e.l_buf+r],r++,a===0?K(e,n,i):(f=ke[n],K(e,f+be+1,i),o=nt[f],o!==0&&(n-=at[f],L(e,n,o)),a--,f=Pt(a),K(e,f,t),o=Ze[f],o!==0&&(a-=Le[f],L(e,a,o)));while(r<e.last_lit);K(e,it,i)},ft=(e,i)=>{const t=i.dyn_tree,a=i.stat_desc.static_tree,n=i.stat_desc.has_stree,r=i.stat_desc.elems;let f,o,g=-1,l;for(e.heap_len=0,e.heap_max=Nt,f=0;f<r;f++)t[f*2]!==0?(e.heap[++e.heap_len]=g=f,e.depth[f]=0):t[f*2+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=g<2?++g:0,t[l*2]=1,e.depth[l]=0,e.opt_len--,n&&(e.static_len-=a[l*2+1]);for(i.max_code=g,f=e.heap_len>>1;f>=1;f--)ot(e,t,f);l=r;do f=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ot(e,t,1),o=e.heap[1],e.heap[--e.heap_max]=f,e.heap[--e.heap_max]=o,t[l*2]=t[f*2]+t[o*2],e.depth[l]=(e.depth[f]>=e.depth[o]?e.depth[f]:e.depth[o])+1,t[f*2+1]=t[o*2+1]=l,e.heap[1]=l++,ot(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],xn(e,i),Wt(t,g,e.bl_count)},jt=(e,i,t)=>{let a,n=-1,r,f=i[0*2+1],o=0,g=7,l=4;for(f===0&&(g=138,l=3),i[(t+1)*2+1]=65535,a=0;a<=t;a++)r=f,f=i[(a+1)*2+1],!(++o<g&&r===f)&&(o<l?e.bl_tree[r*2]+=o:r!==0?(r!==n&&e.bl_tree[r*2]++,e.bl_tree[Zt*2]++):o<=10?e.bl_tree[Lt*2]++:e.bl_tree[Mt*2]++,o=0,n=r,f===0?(g=138,l=3):r===f?(g=6,l=3):(g=7,l=4))},Jt=(e,i,t)=>{let a,n=-1,r,f=i[0*2+1],o=0,g=7,l=4;for(f===0&&(g=138,l=3),a=0;a<=t;a++)if(r=f,f=i[(a+1)*2+1],!(++o<g&&r===f)){if(o<l)do K(e,r,e.bl_tree);while(--o!=0);else r!==0?(r!==n&&(K(e,r,e.bl_tree),o--),K(e,Zt,e.bl_tree),L(e,o-3,2)):o<=10?(K(e,Lt,e.bl_tree),L(e,o-3,3)):(K(e,Mt,e.bl_tree),L(e,o-11,7));o=0,n=r,f===0?(g=138,l=3):r===f?(g=6,l=3):(g=7,l=4)}},kn=e=>{let i;for(jt(e,e.dyn_ltree,e.l_desc.max_code),jt(e,e.dyn_dtree,e.d_desc.max_code),ft(e,e.bl_desc),i=et-1;i>=3&&e.bl_tree[Ft[i]*2+1]===0;i--);return e.opt_len+=3*(i+1)+5+5+4,i},En=(e,i,t,a)=>{let n;for(L(e,i-257,5),L(e,t-1,5),L(e,a-4,4),n=0;n<a;n++)L(e,e.bl_tree[Ft[n]*2+1],3);Jt(e,e.dyn_ltree,i-1),Jt(e,e.dyn_dtree,t-1)},yn=e=>{let i=4093624447,t;for(t=0;t<=31;t++,i>>>=1)if(i&1&&e.dyn_ltree[t*2]!==0)return Ut;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Ot;for(t=32;t<be;t++)if(e.dyn_ltree[t*2]!==0)return Ot;return Ut};let qt=!1;const mn=e=>{qt||(pn(),qt=!0),e.l_desc=new lt(e.dyn_ltree,$t),e.d_desc=new lt(e.dyn_dtree,Ht),e.bl_desc=new lt(e.bl_tree,Bt),e.bi_buf=0,e.bi_valid=0,Gt(e)},Qt=(e,i,t,a)=>{L(e,(cn<<1)+(a?1:0),3),vn(e,i,t,!0)},Sn=e=>{L(e,Ct<<1,3),K(e,it,Y),bn(e)},An=(e,i,t,a)=>{let n,r,f=0;e.level>0?(e.strm.data_type===sn&&(e.strm.data_type=yn(e)),ft(e,e.l_desc),ft(e,e.d_desc),f=kn(e),n=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=n&&(n=r)):n=r=t+5,t+4<=n&&i!==-1?Qt(e,i,t,a):e.strategy===fn||r===n?(L(e,(Ct<<1)+(a?1:0),3),Xt(e,Y,pe)):(L(e,(_n<<1)+(a?1:0),3),En(e,e.l_desc.max_code+1,e.d_desc.max_code+1,f+1),Xt(e,e.dyn_ltree,e.dyn_dtree)),Gt(e),a&&Vt(e)},Tn=(e,i,t)=>(e.pending_buf[e.d_buf+e.last_lit*2]=i>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=i&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,i===0?e.dyn_ltree[t*2]++:(e.matches++,i--,e.dyn_ltree[(ke[t]+be+1)*2]++,e.dyn_dtree[Pt(i)*2]++),e.last_lit===e.lit_bufsize-1);var Rn=mn,Dn=Qt,In=An,zn=Tn,Un=Sn,On={_tr_init:Rn,_tr_stored_block:Dn,_tr_flush_block:In,_tr_tally:zn,_tr_align:Un};const Cn=(e,i,t,a)=>{let n=e&65535|0,r=e>>>16&65535|0,f=0;for(;t!==0;){f=t>2e3?2e3:t,t-=f;do n=n+i[a++]|0,r=r+n|0;while(--f);n%=65521,r%=65521}return n|r<<16|0};var ye=Cn;const Nn=()=>{let e,i=[];for(var t=0;t<256;t++){e=t;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;i[t]=e}return i},Zn=new Uint32Array(Nn()),Ln=(e,i,t,a)=>{const n=Zn,r=a+t;e^=-1;for(let f=a;f<r;f++)e=e>>>8^n[(e^i[f])&255];return e^-1};var C=Ln,he={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},me={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Mn,_tr_stored_block:Fn,_tr_flush_block:$n,_tr_tally:J,_tr_align:Hn}=On,{Z_NO_FLUSH:re,Z_PARTIAL_FLUSH:Bn,Z_FULL_FLUSH:Pn,Z_FINISH:q,Z_BLOCK:ei,Z_OK:W,Z_STREAM_END:ti,Z_STREAM_ERROR:F,Z_DATA_ERROR:Kn,Z_BUF_ERROR:st,Z_DEFAULT_COMPRESSION:Wn,Z_FILTERED:Gn,Z_HUFFMAN_ONLY:Me,Z_RLE:Vn,Z_FIXED:Yn,Z_DEFAULT_STRATEGY:Xn,Z_UNKNOWN:jn,Z_DEFLATED:Fe}=me,Jn=9,qn=15,Qn=8,ea=29,ta=256,ct=ta+1+ea,ia=30,na=19,aa=2*ct+1,ra=15,D=3,Q=258,B=Q+D+1,la=32,$e=42,_t=69,He=73,Be=91,Pe=103,le=113,Se=666,U=1,Ae=2,oe=3,de=4,oa=3,ee=(e,i)=>(e.msg=he[i],i),ii=e=>(e<<1)-(e>4?9:0),te=e=>{let i=e.length;for(;--i>=0;)e[i]=0};let fa=(e,i,t)=>(i<<e.hash_shift^t)&e.hash_mask,ie=fa;const ne=e=>{const i=e.state;let t=i.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(i.pending_buf.subarray(i.pending_out,i.pending_out+t),e.next_out),e.next_out+=t,i.pending_out+=t,e.total_out+=t,e.avail_out-=t,i.pending-=t,i.pending===0&&(i.pending_out=0))},N=(e,i)=>{$n(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,i),e.block_start=e.strstart,ne(e.strm)},I=(e,i)=>{e.pending_buf[e.pending++]=i},Te=(e,i)=>{e.pending_buf[e.pending++]=i>>>8&255,e.pending_buf[e.pending++]=i&255},sa=(e,i,t,a)=>{let n=e.avail_in;return n>a&&(n=a),n===0?0:(e.avail_in-=n,i.set(e.input.subarray(e.next_in,e.next_in+n),t),e.state.wrap===1?e.adler=ye(e.adler,i,n,t):e.state.wrap===2&&(e.adler=C(e.adler,i,n,t)),e.next_in+=n,e.total_in+=n,n)},ni=(e,i)=>{let t=e.max_chain_length,a=e.strstart,n,r,f=e.prev_length,o=e.nice_match;const g=e.strstart>e.w_size-B?e.strstart-(e.w_size-B):0,l=e.window,s=e.w_mask,m=e.prev,w=e.strstart+Q;let c=l[a+f-1],k=l[a+f];e.prev_length>=e.good_match&&(t>>=2),o>e.lookahead&&(o=e.lookahead);do if(n=i,!(l[n+f]!==k||l[n+f-1]!==c||l[n]!==l[a]||l[++n]!==l[a+1])){a+=2,n++;do;while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<w);if(r=Q-(w-a),a=w-Q,r>f){if(e.match_start=i,f=r,r>=o)break;c=l[a+f-1],k=l[a+f]}}while((i=m[i&s])>g&&--t!=0);return f<=e.lookahead?f:e.lookahead},fe=e=>{const i=e.w_size;let t,a,n,r,f;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-B)){e.window.set(e.window.subarray(i,i+i),0),e.match_start-=i,e.strstart-=i,e.block_start-=i,a=e.hash_size,t=a;do n=e.head[--t],e.head[t]=n>=i?n-i:0;while(--a);a=i,t=a;do n=e.prev[--t],e.prev[t]=n>=i?n-i:0;while(--a);r+=i}if(e.strm.avail_in===0)break;if(a=sa(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=a,e.lookahead+e.insert>=D)for(f=e.strstart-e.insert,e.ins_h=e.window[f],e.ins_h=ie(e,e.ins_h,e.window[f+1]);e.insert&&(e.ins_h=ie(e,e.ins_h,e.window[f+D-1]),e.prev[f&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=f,f++,e.insert--,!(e.lookahead+e.insert<D)););}while(e.lookahead<B&&e.strm.avail_in!==0)},ca=(e,i)=>{let t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fe(e),e.lookahead===0&&i===re)return U;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const a=e.block_start+t;if((e.strstart===0||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,N(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-B&&(N(e,!1),e.strm.avail_out===0))return U}return e.insert=0,i===q?(N(e,!0),e.strm.avail_out===0?oe:de):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out===0),U)},ht=(e,i)=>{let t,a;for(;;){if(e.lookahead<B){if(fe(e),e.lookahead<B&&i===re)return U;if(e.lookahead===0)break}if(t=0,e.lookahead>=D&&(e.ins_h=ie(e,e.ins_h,e.window[e.strstart+D-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-B&&(e.match_length=ni(e,t)),e.match_length>=D)if(a=J(e,e.strstart-e.match_start,e.match_length-D),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=D){e.match_length--;do e.strstart++,e.ins_h=ie(e,e.ins_h,e.window[e.strstart+D-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ie(e,e.ins_h,e.window[e.strstart+1]);else a=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(N(e,!1),e.strm.avail_out===0))return U}return e.insert=e.strstart<D-1?e.strstart:D-1,i===q?(N(e,!0),e.strm.avail_out===0?oe:de):e.last_lit&&(N(e,!1),e.strm.avail_out===0)?U:Ae},ue=(e,i)=>{let t,a,n;for(;;){if(e.lookahead<B){if(fe(e),e.lookahead<B&&i===re)return U;if(e.lookahead===0)break}if(t=0,e.lookahead>=D&&(e.ins_h=ie(e,e.ins_h,e.window[e.strstart+D-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=D-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-B&&(e.match_length=ni(e,t),e.match_length<=5&&(e.strategy===Gn||e.match_length===D&&e.strstart-e.match_start>4096)&&(e.match_length=D-1)),e.prev_length>=D&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-D,a=J(e,e.strstart-1-e.prev_match,e.prev_length-D),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=ie(e,e.ins_h,e.window[e.strstart+D-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=D-1,e.strstart++,a&&(N(e,!1),e.strm.avail_out===0))return U}else if(e.match_available){if(a=J(e,0,e.window[e.strstart-1]),a&&N(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return U}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=J(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<D-1?e.strstart:D-1,i===q?(N(e,!0),e.strm.avail_out===0?oe:de):e.last_lit&&(N(e,!1),e.strm.avail_out===0)?U:Ae},_a=(e,i)=>{let t,a,n,r;const f=e.window;for(;;){if(e.lookahead<=Q){if(fe(e),e.lookahead<=Q&&i===re)return U;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=D&&e.strstart>0&&(n=e.strstart-1,a=f[n],a===f[++n]&&a===f[++n]&&a===f[++n])){r=e.strstart+Q;do;while(a===f[++n]&&a===f[++n]&&a===f[++n]&&a===f[++n]&&a===f[++n]&&a===f[++n]&&a===f[++n]&&a===f[++n]&&n<r);e.match_length=Q-(r-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=D?(t=J(e,1,e.match_length-D),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(N(e,!1),e.strm.avail_out===0))return U}return e.insert=0,i===q?(N(e,!0),e.strm.avail_out===0?oe:de):e.last_lit&&(N(e,!1),e.strm.avail_out===0)?U:Ae},ha=(e,i)=>{let t;for(;;){if(e.lookahead===0&&(fe(e),e.lookahead===0)){if(i===re)return U;break}if(e.match_length=0,t=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(N(e,!1),e.strm.avail_out===0))return U}return e.insert=0,i===q?(N(e,!0),e.strm.avail_out===0?oe:de):e.last_lit&&(N(e,!1),e.strm.avail_out===0)?U:Ae};function G(e,i,t,a,n){this.good_length=e,this.max_lazy=i,this.nice_length=t,this.max_chain=a,this.func=n}const Re=[new G(0,0,0,0,ca),new G(4,4,8,4,ht),new G(4,5,16,8,ht),new G(4,6,32,32,ht),new G(4,4,16,16,ue),new G(8,16,32,32,ue),new G(8,16,128,128,ue),new G(8,32,128,256,ue),new G(32,128,258,1024,ue),new G(32,258,258,4096,ue)],da=e=>{e.window_size=2*e.w_size,te(e.head),e.max_lazy_match=Re[e.level].max_lazy,e.good_match=Re[e.level].good_length,e.nice_match=Re[e.level].nice_length,e.max_chain_length=Re[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=D-1,e.match_available=0,e.ins_h=0};function ua(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Fe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(aa*2),this.dyn_dtree=new Uint16Array((2*ia+1)*2),this.bl_tree=new Uint16Array((2*na+1)*2),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ra+1),this.heap=new Uint16Array(2*ct+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ct+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ai=e=>{if(!e||!e.state)return ee(e,F);e.total_in=e.total_out=0,e.data_type=jn;const i=e.state;return i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?$e:le,e.adler=i.wrap===2?0:1,i.last_flush=re,Mn(i),W},ri=e=>{const i=ai(e);return i===W&&da(e.state),i},ga=(e,i)=>!e||!e.state||e.state.wrap!==2?F:(e.state.gzhead=i,W),li=(e,i,t,a,n,r)=>{if(!e)return F;let f=1;if(i===Wn&&(i=6),a<0?(f=0,a=-a):a>15&&(f=2,a-=16),n<1||n>Jn||t!==Fe||a<8||a>15||i<0||i>9||r<0||r>Yn)return ee(e,F);a===8&&(a=9);const o=new ua;return e.state=o,o.strm=e,o.wrap=f,o.gzhead=null,o.w_bits=a,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+D-1)/D),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=i,o.strategy=r,o.method=t,ri(e)},wa=(e,i)=>li(e,i,Fe,qn,Qn,Xn),ba=(e,i)=>{let t,a;if(!e||!e.state||i>ei||i<0)return e?ee(e,F):F;const n=e.state;if(!e.output||!e.input&&e.avail_in!==0||n.status===Se&&i!==q)return ee(e,e.avail_out===0?st:F);n.strm=e;const r=n.last_flush;if(n.last_flush=i,n.status===$e)if(n.wrap===2)e.adler=0,I(n,31),I(n,139),I(n,8),n.gzhead?(I(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),I(n,n.gzhead.time&255),I(n,n.gzhead.time>>8&255),I(n,n.gzhead.time>>16&255),I(n,n.gzhead.time>>24&255),I(n,n.level===9?2:n.strategy>=Me||n.level<2?4:0),I(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(I(n,n.gzhead.extra.length&255),I(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=C(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=_t):(I(n,0),I(n,0),I(n,0),I(n,0),I(n,0),I(n,n.level===9?2:n.strategy>=Me||n.level<2?4:0),I(n,oa),n.status=le);else{let f=Fe+(n.w_bits-8<<4)<<8,o=-1;n.strategy>=Me||n.level<2?o=0:n.level<6?o=1:n.level===6?o=2:o=3,f|=o<<6,n.strstart!==0&&(f|=la),f+=31-f%31,n.status=le,Te(n,f),n.strstart!==0&&(Te(n,e.adler>>>16),Te(n,e.adler&65535)),e.adler=1}if(n.status===_t)if(n.gzhead.extra){for(t=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),ne(e),t=n.pending,n.pending===n.pending_buf_size));)I(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=He)}else n.status=He;if(n.status===He)if(n.gzhead.name){t=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),ne(e),t=n.pending,n.pending===n.pending_buf_size)){a=1;break}n.gzindex<n.gzhead.name.length?a=n.gzhead.name.charCodeAt(n.gzindex++)&255:a=0,I(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),a===0&&(n.gzindex=0,n.status=Be)}else n.status=Be;if(n.status===Be)if(n.gzhead.comment){t=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),ne(e),t=n.pending,n.pending===n.pending_buf_size)){a=1;break}n.gzindex<n.gzhead.comment.length?a=n.gzhead.comment.charCodeAt(n.gzindex++)&255:a=0,I(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>t&&(e.adler=C(e.adler,n.pending_buf,n.pending-t,t)),a===0&&(n.status=Pe)}else n.status=Pe;if(n.status===Pe&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ne(e),n.pending+2<=n.pending_buf_size&&(I(n,e.adler&255),I(n,e.adler>>8&255),e.adler=0,n.status=le)):n.status=le),n.pending!==0){if(ne(e),e.avail_out===0)return n.last_flush=-1,W}else if(e.avail_in===0&&ii(i)<=ii(r)&&i!==q)return ee(e,st);if(n.status===Se&&e.avail_in!==0)return ee(e,st);if(e.avail_in!==0||n.lookahead!==0||i!==re&&n.status!==Se){let f=n.strategy===Me?ha(n,i):n.strategy===Vn?_a(n,i):Re[n.level].func(n,i);if((f===oe||f===de)&&(n.status=Se),f===U||f===oe)return e.avail_out===0&&(n.last_flush=-1),W;if(f===Ae&&(i===Bn?Hn(n):i!==ei&&(Fn(n,0,0,!1),i===Pn&&(te(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),ne(e),e.avail_out===0))return n.last_flush=-1,W}return i!==q?W:n.wrap<=0?ti:(n.wrap===2?(I(n,e.adler&255),I(n,e.adler>>8&255),I(n,e.adler>>16&255),I(n,e.adler>>24&255),I(n,e.total_in&255),I(n,e.total_in>>8&255),I(n,e.total_in>>16&255),I(n,e.total_in>>24&255)):(Te(n,e.adler>>>16),Te(n,e.adler&65535)),ne(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?W:ti)},xa=e=>{if(!e||!e.state)return F;const i=e.state.status;return i!==$e&&i!==_t&&i!==He&&i!==Be&&i!==Pe&&i!==le&&i!==Se?ee(e,F):(e.state=null,i===le?ee(e,Kn):W)},pa=(e,i)=>{let t=i.length;if(!e||!e.state)return F;const a=e.state,n=a.wrap;if(n===2||n===1&&a.status!==$e||a.lookahead)return F;if(n===1&&(e.adler=ye(e.adler,i,t,0)),a.wrap=0,t>=a.w_size){n===0&&(te(a.head),a.strstart=0,a.block_start=0,a.insert=0);let g=new Uint8Array(a.w_size);g.set(i.subarray(t-a.w_size,t),0),i=g,t=a.w_size}const r=e.avail_in,f=e.next_in,o=e.input;for(e.avail_in=t,e.next_in=0,e.input=i,fe(a);a.lookahead>=D;){let g=a.strstart,l=a.lookahead-(D-1);do a.ins_h=ie(a,a.ins_h,a.window[g+D-1]),a.prev[g&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=g,g++;while(--l);a.strstart=g,a.lookahead=D-1,fe(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=D-1,a.match_available=0,e.next_in=f,e.input=o,e.avail_in=r,a.wrap=n,W};var va=wa,ka=li,Ea=ri,ya=ai,ma=ga,Sa=ba,Aa=xa,Ta=pa,Ra="pako deflate (from Nodeca project)",De={deflateInit:va,deflateInit2:ka,deflateReset:Ea,deflateResetKeep:ya,deflateSetHeader:ma,deflate:Sa,deflateEnd:Aa,deflateSetDictionary:Ta,deflateInfo:Ra};const Da=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var Ia=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const t=i.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const a in t)Da(t,a)&&(e[a]=t[a])}}return e},za=e=>{let i=0;for(let a=0,n=e.length;a<n;a++)i+=e[a].length;const t=new Uint8Array(i);for(let a=0,n=0,r=e.length;a<r;a++){let f=e[a];t.set(f,n),n+=f.length}return t},Ke={assign:Ia,flattenChunks:za};let oi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){oi=!1}const Ie=new Uint8Array(256);for(let e=0;e<256;e++)Ie[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ie[254]=Ie[254]=1;var Ua=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let i,t,a,n,r,f=e.length,o=0;for(n=0;n<f;n++)t=e.charCodeAt(n),(t&64512)==55296&&n+1<f&&(a=e.charCodeAt(n+1),(a&64512)==56320&&(t=65536+(t-55296<<10)+(a-56320),n++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(i=new Uint8Array(o),r=0,n=0;r<o;n++)t=e.charCodeAt(n),(t&64512)==55296&&n+1<f&&(a=e.charCodeAt(n+1),(a&64512)==56320&&(t=65536+(t-55296<<10)+(a-56320),n++)),t<128?i[r++]=t:t<2048?(i[r++]=192|t>>>6,i[r++]=128|t&63):t<65536?(i[r++]=224|t>>>12,i[r++]=128|t>>>6&63,i[r++]=128|t&63):(i[r++]=240|t>>>18,i[r++]=128|t>>>12&63,i[r++]=128|t>>>6&63,i[r++]=128|t&63);return i};const Oa=(e,i)=>{if(i<65534&&e.subarray&&oi)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let t="";for(let a=0;a<i;a++)t+=String.fromCharCode(e[a]);return t};var Ca=(e,i)=>{const t=i||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,i));let a,n;const r=new Array(t*2);for(n=0,a=0;a<t;){let f=e[a++];if(f<128){r[n++]=f;continue}let o=Ie[f];if(o>4){r[n++]=65533,a+=o-1;continue}for(f&=o===2?31:o===3?15:7;o>1&&a<t;)f=f<<6|e[a++]&63,o--;if(o>1){r[n++]=65533;continue}f<65536?r[n++]=f:(f-=65536,r[n++]=55296|f>>10&1023,r[n++]=56320|f&1023)}return Oa(r,n)},Na=(e,i)=>{i=i||e.length,i>e.length&&(i=e.length);let t=i-1;for(;t>=0&&(e[t]&192)==128;)t--;return t<0||t===0?i:t+Ie[e[t]]>i?t:i},ze={string2buf:Ua,buf2string:Ca,utf8border:Na};function Za(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var fi=Za;const si=Object.prototype.toString,{Z_NO_FLUSH:La,Z_SYNC_FLUSH:Ma,Z_FULL_FLUSH:Fa,Z_FINISH:$a,Z_OK:We,Z_STREAM_END:Ha,Z_DEFAULT_COMPRESSION:Ba,Z_DEFAULT_STRATEGY:Pa,Z_DEFLATED:Ka}=me;function dt(e){this.options=Ke.assign({level:Ba,method:Ka,chunkSize:16384,windowBits:15,memLevel:8,strategy:Pa},e||{});let i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new fi,this.strm.avail_out=0;let t=De.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(t!==We)throw new Error(he[t]);if(i.header&&De.deflateSetHeader(this.strm,i.header),i.dictionary){let a;if(typeof i.dictionary=="string"?a=ze.string2buf(i.dictionary):si.call(i.dictionary)==="[object ArrayBuffer]"?a=new Uint8Array(i.dictionary):a=i.dictionary,t=De.deflateSetDictionary(this.strm,a),t!==We)throw new Error(he[t]);this._dict_set=!0}}dt.prototype.push=function(e,i){const t=this.strm,a=this.options.chunkSize;let n,r;if(this.ended)return!1;for(i===~~i?r=i:r=i===!0?$a:La,typeof e=="string"?t.input=ze.string2buf(e):si.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(a),t.next_out=0,t.avail_out=a),(r===Ma||r===Fa)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(n=De.deflate(t,r),n===Ha)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),n=De.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===We;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0},dt.prototype.onData=function(e){this.chunks.push(e)},dt.prototype.onEnd=function(e){e===We&&(this.result=Ke.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const Ge=30,Wa=12;var Ga=function(i,t){let a,n,r,f,o,g,l,s,m,w,c,k,h,_,u,E,b,d,p,A,x,v,y,S;const T=i.state;a=i.next_in,y=i.input,n=a+(i.avail_in-5),r=i.next_out,S=i.output,f=r-(t-i.avail_out),o=r+(i.avail_out-257),g=T.dmax,l=T.wsize,s=T.whave,m=T.wnext,w=T.window,c=T.hold,k=T.bits,h=T.lencode,_=T.distcode,u=(1<<T.lenbits)-1,E=(1<<T.distbits)-1;e:do{k<15&&(c+=y[a++]<<k,k+=8,c+=y[a++]<<k,k+=8),b=h[c&u];t:for(;;){if(d=b>>>24,c>>>=d,k-=d,d=b>>>16&255,d===0)S[r++]=b&65535;else if(d&16){p=b&65535,d&=15,d&&(k<d&&(c+=y[a++]<<k,k+=8),p+=c&(1<<d)-1,c>>>=d,k-=d),k<15&&(c+=y[a++]<<k,k+=8,c+=y[a++]<<k,k+=8),b=_[c&E];i:for(;;){if(d=b>>>24,c>>>=d,k-=d,d=b>>>16&255,d&16){if(A=b&65535,d&=15,k<d&&(c+=y[a++]<<k,k+=8,k<d&&(c+=y[a++]<<k,k+=8)),A+=c&(1<<d)-1,A>g){i.msg="invalid distance too far back",T.mode=Ge;break e}if(c>>>=d,k-=d,d=r-f,A>d){if(d=A-d,d>s&&T.sane){i.msg="invalid distance too far back",T.mode=Ge;break e}if(x=0,v=w,m===0){if(x+=l-d,d<p){p-=d;do S[r++]=w[x++];while(--d);x=r-A,v=S}}else if(m<d){if(x+=l+m-d,d-=m,d<p){p-=d;do S[r++]=w[x++];while(--d);if(x=0,m<p){d=m,p-=d;do S[r++]=w[x++];while(--d);x=r-A,v=S}}}else if(x+=m-d,d<p){p-=d;do S[r++]=w[x++];while(--d);x=r-A,v=S}for(;p>2;)S[r++]=v[x++],S[r++]=v[x++],S[r++]=v[x++],p-=3;p&&(S[r++]=v[x++],p>1&&(S[r++]=v[x++]))}else{x=r-A;do S[r++]=S[x++],S[r++]=S[x++],S[r++]=S[x++],p-=3;while(p>2);p&&(S[r++]=S[x++],p>1&&(S[r++]=S[x++]))}}else if((d&64)==0){b=_[(b&65535)+(c&(1<<d)-1)];continue i}else{i.msg="invalid distance code",T.mode=Ge;break e}break}}else if((d&64)==0){b=h[(b&65535)+(c&(1<<d)-1)];continue t}else if(d&32){T.mode=Wa;break e}else{i.msg="invalid literal/length code",T.mode=Ge;break e}break}}while(a<n&&r<o);p=k>>3,a-=p,k-=p<<3,c&=(1<<k)-1,i.next_in=a,i.next_out=r,i.avail_in=a<n?5+(n-a):5-(a-n),i.avail_out=r<o?257+(o-r):257-(r-o),T.hold=c,T.bits=k};const ge=15,ci=852,_i=592,hi=0,ut=1,di=2,Va=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ya=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Xa=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ja=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Ja=(e,i,t,a,n,r,f,o)=>{const g=o.bits;let l=0,s=0,m=0,w=0,c=0,k=0,h=0,_=0,u=0,E=0,b,d,p,A,x,v=null,y=0,S;const T=new Uint16Array(ge+1),M=new Uint16Array(ge+1);let P=null,O=0,R,H,Z;for(l=0;l<=ge;l++)T[l]=0;for(s=0;s<a;s++)T[i[t+s]]++;for(c=g,w=ge;w>=1&&T[w]===0;w--);if(c>w&&(c=w),w===0)return n[r++]=1<<24|64<<16|0,n[r++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<w&&T[m]===0;m++);for(c<m&&(c=m),_=1,l=1;l<=ge;l++)if(_<<=1,_-=T[l],_<0)return-1;if(_>0&&(e===hi||w!==1))return-1;for(M[1]=0,l=1;l<ge;l++)M[l+1]=M[l]+T[l];for(s=0;s<a;s++)i[t+s]!==0&&(f[M[i[t+s]]++]=s);if(e===hi?(v=P=f,S=19):e===ut?(v=Va,y-=257,P=Ya,O-=257,S=256):(v=Xa,P=ja,S=-1),E=0,s=0,l=m,x=r,k=c,h=0,p=-1,u=1<<c,A=u-1,e===ut&&u>ci||e===di&&u>_i)return 1;for(;;){R=l-h,f[s]<S?(H=0,Z=f[s]):f[s]>S?(H=P[O+f[s]],Z=v[y+f[s]]):(H=32+64,Z=0),b=1<<l-h,d=1<<k,m=d;do d-=b,n[x+(E>>h)+d]=R<<24|H<<16|Z|0;while(d!==0);for(b=1<<l-1;E&b;)b>>=1;if(b!==0?(E&=b-1,E+=b):E=0,s++,--T[l]==0){if(l===w)break;l=i[t+f[s]]}if(l>c&&(E&A)!==p){for(h===0&&(h=c),x+=m,k=l-h,_=1<<k;k+h<w&&(_-=T[k+h],!(_<=0));)k++,_<<=1;if(u+=1<<k,e===ut&&u>ci||e===di&&u>_i)return 1;p=E&A,n[p]=c<<24|k<<16|x-r|0}}return E!==0&&(n[x+E]=l-h<<24|64<<16|0),o.bits=c,0};var Ue=Ja;const qa=0,ui=1,gi=2,{Z_FINISH:wi,Z_BLOCK:Qa,Z_TREES:Ve,Z_OK:se,Z_STREAM_END:er,Z_NEED_DICT:tr,Z_STREAM_ERROR:$,Z_DATA_ERROR:bi,Z_MEM_ERROR:xi,Z_BUF_ERROR:ir,Z_DEFLATED:pi}=me,vi=1,ki=2,Ei=3,yi=4,mi=5,Si=6,Ai=7,Ti=8,Ri=9,Di=10,Ye=11,X=12,gt=13,Ii=14,wt=15,zi=16,Ui=17,Oi=18,Ci=19,Xe=20,je=21,Ni=22,Zi=23,Li=24,Mi=25,Fi=26,bt=27,$i=28,Hi=29,z=30,Bi=31,nr=32,ar=852,rr=592,lr=15,or=lr,Pi=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function fr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ki=e=>{if(!e||!e.state)return $;const i=e.state;return e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=vi,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(ar),i.distcode=i.distdyn=new Int32Array(rr),i.sane=1,i.back=-1,se},Wi=e=>{if(!e||!e.state)return $;const i=e.state;return i.wsize=0,i.whave=0,i.wnext=0,Ki(e)},Gi=(e,i)=>{let t;if(!e||!e.state)return $;const a=e.state;return i<0?(t=0,i=-i):(t=(i>>4)+1,i<48&&(i&=15)),i&&(i<8||i>15)?$:(a.window!==null&&a.wbits!==i&&(a.window=null),a.wrap=t,a.wbits=i,Wi(e))},Vi=(e,i)=>{if(!e)return $;const t=new fr;e.state=t,t.window=null;const a=Gi(e,i);return a!==se&&(e.state=null),a},sr=e=>Vi(e,or);let Yi=!0,xt,pt;const cr=e=>{if(Yi){xt=new Int32Array(512),pt=new Int32Array(32);let i=0;for(;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for(Ue(ui,e.lens,0,288,xt,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;Ue(gi,e.lens,0,32,pt,0,e.work,{bits:5}),Yi=!1}e.lencode=xt,e.lenbits=9,e.distcode=pt,e.distbits=5},Xi=(e,i,t,a)=>{let n;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),a>=r.wsize?(r.window.set(i.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>a&&(n=a),r.window.set(i.subarray(t-a,t-a+n),r.wnext),a-=n,a?(r.window.set(i.subarray(t-a,t),0),r.wnext=a,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0},_r=(e,i)=>{let t,a,n,r,f,o,g,l,s,m,w,c,k,h,_=0,u,E,b,d,p,A,x,v;const y=new Uint8Array(4);let S,T;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return $;t=e.state,t.mode===X&&(t.mode=gt),f=e.next_out,n=e.output,g=e.avail_out,r=e.next_in,a=e.input,o=e.avail_in,l=t.hold,s=t.bits,m=o,w=g,v=se;e:for(;;)switch(t.mode){case vi:if(t.wrap===0){t.mode=gt;break}for(;s<16;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(t.wrap&2&&l===35615){t.check=0,y[0]=l&255,y[1]=l>>>8&255,t.check=C(t.check,y,2,0),l=0,s=0,t.mode=ki;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=z;break}if((l&15)!==pi){e.msg="unknown compression method",t.mode=z;break}if(l>>>=4,s-=4,x=(l&15)+8,t.wbits===0)t.wbits=x;else if(x>t.wbits){e.msg="invalid window size",t.mode=z;break}t.dmax=1<<t.wbits,e.adler=t.check=1,t.mode=l&512?Di:X,l=0,s=0;break;case ki:for(;s<16;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(t.flags=l,(t.flags&255)!==pi){e.msg="unknown compression method",t.mode=z;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=z;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,t.check=C(t.check,y,2,0)),l=0,s=0,t.mode=Ei;case Ei:for(;s<32;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.head&&(t.head.time=l),t.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,y[2]=l>>>16&255,y[3]=l>>>24&255,t.check=C(t.check,y,4,0)),l=0,s=0,t.mode=yi;case yi:for(;s<16;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,t.check=C(t.check,y,2,0)),l=0,s=0,t.mode=mi;case mi:if(t.flags&1024){for(;s<16;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,t.check=C(t.check,y,2,0)),l=0,s=0}else t.head&&(t.head.extra=null);t.mode=Si;case Si:if(t.flags&1024&&(c=t.length,c>o&&(c=o),c&&(t.head&&(x=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(a.subarray(r,r+c),x)),t.flags&512&&(t.check=C(t.check,a,c,r)),o-=c,r+=c,t.length-=c),t.length))break e;t.length=0,t.mode=Ai;case Ai:if(t.flags&2048){if(o===0)break e;c=0;do x=a[r+c++],t.head&&x&&t.length<65536&&(t.head.name+=String.fromCharCode(x));while(x&&c<o);if(t.flags&512&&(t.check=C(t.check,a,c,r)),o-=c,r+=c,x)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Ti;case Ti:if(t.flags&4096){if(o===0)break e;c=0;do x=a[r+c++],t.head&&x&&t.length<65536&&(t.head.comment+=String.fromCharCode(x));while(x&&c<o);if(t.flags&512&&(t.check=C(t.check,a,c,r)),o-=c,r+=c,x)break e}else t.head&&(t.head.comment=null);t.mode=Ri;case Ri:if(t.flags&512){for(;s<16;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=z;break}l=0,s=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=X;break;case Di:for(;s<32;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}e.adler=t.check=Pi(l),l=0,s=0,t.mode=Ye;case Ye:if(t.havedict===0)return e.next_out=f,e.avail_out=g,e.next_in=r,e.avail_in=o,t.hold=l,t.bits=s,tr;e.adler=t.check=1,t.mode=X;case X:if(i===Qa||i===Ve)break e;case gt:if(t.last){l>>>=s&7,s-=s&7,t.mode=bt;break}for(;s<3;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}switch(t.last=l&1,l>>>=1,s-=1,l&3){case 0:t.mode=Ii;break;case 1:if(cr(t),t.mode=Xe,i===Ve){l>>>=2,s-=2;break e}break;case 2:t.mode=Ui;break;case 3:e.msg="invalid block type",t.mode=z}l>>>=2,s-=2;break;case Ii:for(l>>>=s&7,s-=s&7;s<32;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if((l&65535)!=(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=z;break}if(t.length=l&65535,l=0,s=0,t.mode=wt,i===Ve)break e;case wt:t.mode=zi;case zi:if(c=t.length,c){if(c>o&&(c=o),c>g&&(c=g),c===0)break e;n.set(a.subarray(r,r+c),f),o-=c,r+=c,g-=c,f+=c,t.length-=c;break}t.mode=X;break;case Ui:for(;s<14;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(t.nlen=(l&31)+257,l>>>=5,s-=5,t.ndist=(l&31)+1,l>>>=5,s-=5,t.ncode=(l&15)+4,l>>>=4,s-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=z;break}t.have=0,t.mode=Oi;case Oi:for(;t.have<t.ncode;){for(;s<3;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.lens[M[t.have++]]=l&7,l>>>=3,s-=3}for(;t.have<19;)t.lens[M[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,S={bits:t.lenbits},v=Ue(qa,t.lens,0,19,t.lencode,0,t.work,S),t.lenbits=S.bits,v){e.msg="invalid code lengths set",t.mode=z;break}t.have=0,t.mode=Ci;case Ci:for(;t.have<t.nlen+t.ndist;){for(;_=t.lencode[l&(1<<t.lenbits)-1],u=_>>>24,E=_>>>16&255,b=_&65535,!(u<=s);){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(b<16)l>>>=u,s-=u,t.lens[t.have++]=b;else{if(b===16){for(T=u+2;s<T;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(l>>>=u,s-=u,t.have===0){e.msg="invalid bit length repeat",t.mode=z;break}x=t.lens[t.have-1],c=3+(l&3),l>>>=2,s-=2}else if(b===17){for(T=u+3;s<T;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}l>>>=u,s-=u,x=0,c=3+(l&7),l>>>=3,s-=3}else{for(T=u+7;s<T;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}l>>>=u,s-=u,x=0,c=11+(l&127),l>>>=7,s-=7}if(t.have+c>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=z;break}for(;c--;)t.lens[t.have++]=x}}if(t.mode===z)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=z;break}if(t.lenbits=9,S={bits:t.lenbits},v=Ue(ui,t.lens,0,t.nlen,t.lencode,0,t.work,S),t.lenbits=S.bits,v){e.msg="invalid literal/lengths set",t.mode=z;break}if(t.distbits=6,t.distcode=t.distdyn,S={bits:t.distbits},v=Ue(gi,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,S),t.distbits=S.bits,v){e.msg="invalid distances set",t.mode=z;break}if(t.mode=Xe,i===Ve)break e;case Xe:t.mode=je;case je:if(o>=6&&g>=258){e.next_out=f,e.avail_out=g,e.next_in=r,e.avail_in=o,t.hold=l,t.bits=s,Ga(e,w),f=e.next_out,n=e.output,g=e.avail_out,r=e.next_in,a=e.input,o=e.avail_in,l=t.hold,s=t.bits,t.mode===X&&(t.back=-1);break}for(t.back=0;_=t.lencode[l&(1<<t.lenbits)-1],u=_>>>24,E=_>>>16&255,b=_&65535,!(u<=s);){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(E&&(E&240)==0){for(d=u,p=E,A=b;_=t.lencode[A+((l&(1<<d+p)-1)>>d)],u=_>>>24,E=_>>>16&255,b=_&65535,!(d+u<=s);){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}l>>>=d,s-=d,t.back+=d}if(l>>>=u,s-=u,t.back+=u,t.length=b,E===0){t.mode=Fi;break}if(E&32){t.back=-1,t.mode=X;break}if(E&64){e.msg="invalid literal/length code",t.mode=z;break}t.extra=E&15,t.mode=Ni;case Ni:if(t.extra){for(T=t.extra;s<T;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,s-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Zi;case Zi:for(;_=t.distcode[l&(1<<t.distbits)-1],u=_>>>24,E=_>>>16&255,b=_&65535,!(u<=s);){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if((E&240)==0){for(d=u,p=E,A=b;_=t.distcode[A+((l&(1<<d+p)-1)>>d)],u=_>>>24,E=_>>>16&255,b=_&65535,!(d+u<=s);){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}l>>>=d,s-=d,t.back+=d}if(l>>>=u,s-=u,t.back+=u,E&64){e.msg="invalid distance code",t.mode=z;break}t.offset=b,t.extra=E&15,t.mode=Li;case Li:if(t.extra){for(T=t.extra;s<T;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,s-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=z;break}t.mode=Mi;case Mi:if(g===0)break e;if(c=w-g,t.offset>c){if(c=t.offset-c,c>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=z;break}c>t.wnext?(c-=t.wnext,k=t.wsize-c):k=t.wnext-c,c>t.length&&(c=t.length),h=t.window}else h=n,k=f-t.offset,c=t.length;c>g&&(c=g),g-=c,t.length-=c;do n[f++]=h[k++];while(--c);t.length===0&&(t.mode=je);break;case Fi:if(g===0)break e;n[f++]=t.length,g--,t.mode=je;break;case bt:if(t.wrap){for(;s<32;){if(o===0)break e;o--,l|=a[r++]<<s,s+=8}if(w-=g,e.total_out+=w,t.total+=w,w&&(e.adler=t.check=t.flags?C(t.check,n,w,f-w):ye(t.check,n,w,f-w)),w=g,(t.flags?l:Pi(l))!==t.check){e.msg="incorrect data check",t.mode=z;break}l=0,s=0}t.mode=$i;case $i:if(t.wrap&&t.flags){for(;s<32;){if(o===0)break e;o--,l+=a[r++]<<s,s+=8}if(l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=z;break}l=0,s=0}t.mode=Hi;case Hi:v=er;break e;case z:v=bi;break e;case Bi:return xi;case nr:default:return $}return e.next_out=f,e.avail_out=g,e.next_in=r,e.avail_in=o,t.hold=l,t.bits=s,(t.wsize||w!==e.avail_out&&t.mode<z&&(t.mode<bt||i!==wi))&&Xi(e,e.output,e.next_out,w-e.avail_out),m-=e.avail_in,w-=e.avail_out,e.total_in+=m,e.total_out+=w,t.total+=w,t.wrap&&w&&(e.adler=t.check=t.flags?C(t.check,n,w,e.next_out-w):ye(t.check,n,w,e.next_out-w)),e.data_type=t.bits+(t.last?64:0)+(t.mode===X?128:0)+(t.mode===Xe||t.mode===wt?256:0),(m===0&&w===0||i===wi)&&v===se&&(v=ir),v},hr=e=>{if(!e||!e.state)return $;let i=e.state;return i.window&&(i.window=null),e.state=null,se},dr=(e,i)=>{if(!e||!e.state)return $;const t=e.state;return(t.wrap&2)==0?$:(t.head=i,i.done=!1,se)},ur=(e,i)=>{const t=i.length;let a,n,r;return!e||!e.state||(a=e.state,a.wrap!==0&&a.mode!==Ye)?$:a.mode===Ye&&(n=1,n=ye(n,i,t,0),n!==a.check)?bi:(r=Xi(e,i,t,t),r?(a.mode=Bi,xi):(a.havedict=1,se))};var gr=Wi,wr=Gi,br=Ki,xr=sr,pr=Vi,vr=_r,kr=hr,Er=dr,yr=ur,mr="pako inflate (from Nodeca project)",j={inflateReset:gr,inflateReset2:wr,inflateResetKeep:br,inflateInit:xr,inflateInit2:pr,inflate:vr,inflateEnd:kr,inflateGetHeader:Er,inflateSetDictionary:yr,inflateInfo:mr};function Sr(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ar=Sr;const ji=Object.prototype.toString,{Z_NO_FLUSH:Tr,Z_FINISH:Rr,Z_OK:Oe,Z_STREAM_END:vt,Z_NEED_DICT:kt,Z_STREAM_ERROR:Dr,Z_DATA_ERROR:Ji,Z_MEM_ERROR:Ir}=me;function Ce(e){this.options=Ke.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),i.windowBits>=0&&i.windowBits<16&&!(e&&e.windowBits)&&(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&(i.windowBits&15)==0&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new fi,this.strm.avail_out=0;let t=j.inflateInit2(this.strm,i.windowBits);if(t!==Oe)throw new Error(he[t]);if(this.header=new Ar,j.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=ze.string2buf(i.dictionary):ji.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(t=j.inflateSetDictionary(this.strm,i.dictionary),t!==Oe)))throw new Error(he[t])}Ce.prototype.push=function(e,i){const t=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let r,f,o;if(this.ended)return!1;for(i===~~i?f=i:f=i===!0?Rr:Tr,ji.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(a),t.next_out=0,t.avail_out=a),r=j.inflate(t,f),r===kt&&n&&(r=j.inflateSetDictionary(t,n),r===Oe?r=j.inflate(t,f):r===Ji&&(r=kt));t.avail_in>0&&r===vt&&t.state.wrap>0&&e[t.next_in]!==0;)j.inflateReset(t),r=j.inflate(t,f);switch(r){case Dr:case Ji:case kt:case Ir:return this.onEnd(r),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||r===vt))if(this.options.to==="string"){let g=ze.utf8border(t.output,t.next_out),l=t.next_out-g,s=ze.buf2string(t.output,g);t.next_out=l,t.avail_out=a-l,l&&t.output.set(t.output.subarray(g,g+l),0),this.onData(s)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===Oe&&o===0)){if(r===vt)return r=j.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},Ce.prototype.onData=function(e){this.chunks.push(e)},Ce.prototype.onEnd=function(e){e===Oe&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ke.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Et(e,i){const t=new Ce(i);if(t.push(e),t.err)throw t.msg||he[t.err];return t.result}function zr(e,i){return i=i||{},i.raw=!0,Et(e,i)}var Ur=Ce,Or=Et,Cr=zr,Nr=Et,Zr=me,Lr={Inflate:Ur,inflate:Or,inflateRaw:Cr,ungzip:Nr,constants:Zr};const{Inflate:Gr,inflate:Mr,inflateRaw:Vr,ungzip:Yr}=Lr;var Fr=Mr;function qi(e){const i=new ArrayBuffer(e.length),t=new Uint8Array(i);for(let a=0,n=e.length;a<n;a++)t[a]=e.charCodeAt(a);return i}class yt{constructor(){}static async fromSPKI(i){const t=window.atob(i),a=qi(t),n=!0,r="spki";let f={name:"ECDSA",namedCurve:"P-256"};return await crypto.subtle.importKey(r,a,f,n,["verify"])}static async fromJWK(i){i.use="sig";const t=!0,a="jwk",n=i.kty;let r;if(n=="EC")r={name:"ECDSA",namedCurve:"P-256"};else if(n=="RSA")r={name:"RSA-PSS",hash:"SHA-256"};else throw new Error(`Invalid key type specified: ${i.kty}`);let f=i.d?["sign"]:["verify"];return await crypto.subtle.importKey(a,i,r,t,f)}static async generateECDSAKeyPair(){const i=!0,t={name:"ECDSA",namedCurve:"P-256"},a=["sign","verify"];return await crypto.subtle.generateKey(t,i,a)}static async generateEncryptionKey(){return await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}static async exportToJWK(i){return await crypto.subtle.exportKey("jwk",i)}static async exportToPEM(i){return await crypto.subtle.exportKey("spki",i)}static async importFromPEMRaw(i){const t=window.atob(i);console.log(t);const a=qi(t);return console.log(a),await crypto.subtle.importKey("spki",a,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"])}static async sign(i,t){if(i.type!="private")throw new Error("Not a private key");return await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},i,t)}static async verify(i,t,a){if(i.type!="public")throw new Error("Not a public key");console.log("Inside VERIFY",i);let n=i.algorithm;if(console.log("Key algorithm",n),i.algorithm.name==="RSA-PSS")n={name:"RSA-PSS",saltLength:32};else if(i.algorithm.name==="ECDSA")n={name:"ECDSA",hash:"SHA-256"};else throw`Invalid signature algorithm: ${i.algorithm.name}`;let r;try{r=await window.crypto.subtle.verify(n,i,t,a)}catch(f){throw`Verification of payload failed: ${f}`}return console.log("Result:",r),r}static async encryptMessage(i,t){if(i.type!="secret")throw new Error("Not a symmetric encryption key");let a=crypto.getRandomValues(new Uint8Array(12)),n=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},i,t);return{iv:a,ciphertext:n}}static async decryptMessage(i,t,a){if(i.type!="secret")throw new Error("Not a symmetric encryption key");return await window.crypto.subtle.decrypt({name:"AES-GCM",iv:t},i,a)}}const Qi=45,$r=2025,en=2,mt=3,tn=256,nn=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];var Je;function Hr(e){if(e==null)throw new Error("utf8StringArg is null or undefined.");if(e.length===0)return[];var i=e.length%mt;if(i===1)throw new Error("utf8StringArg has incorrect length.");if(Je===void 0){Je={};for(let o=0;o<nn.length;++o)Je[nn[o]]=o}const t=new Array(e.length);for(let o=0;o<e.length;++o){const g=Je[e[o]];if(g===void 0)throw new Error("Invalid character at position ".concat(o).concat("."));t[o]=g}const a=Math.trunc(t.length/mt);var n=new Array(a*en+(i===en?1:0)),r=0;const f=a*mt;for(let o=0;o<f;){const g=t[o++]+Qi*t[o++]+$r*t[o++];n[r++]=Math.trunc(g/tn),n[r++]=g%tn}return i===0||(n[n.length-1]=t[t.length-2]+Qi*t[t.length-1]),n}const Br=18,St=0,At=1,Tt=2,Rt=3,Dt=4,qe=5,It=6,an=7,Pr=1,rn=4;new TextEncoder,new TextDecoder;var zt=new Map;zt.set(-7,"ES256"),zt.set(-37,"RSA");const V=class{static encode(i){var t=new ArrayBuffer(256),a=new DataView(t),n,r=0;function f(_){for(var u=t.byteLength,E=r+_;u<E;)u<<=1;if(u!==t.byteLength){var b=a;t=new ArrayBuffer(u),a=new DataView(t);for(var d=r+3>>2,p=0;p<d;++p)a.setUint32(p<<2,b.getUint32(p<<2))}return n=_,a}function o(){r+=n}function g(_){o(f(8).setFloat64(r,_))}function l(_){o(f(1).setUint8(r,_))}function s(_){for(var u=f(_.length),E=0;E<_.length;++E)u.setUint8(r+E,_[E]);o()}function m(_){o(f(2).setUint16(r,_))}function w(_){o(f(4).setUint32(r,_))}function c(_){var u=_%POW_2_32,E=(_-u)/POW_2_32,b=f(8);b.setUint32(r,E),b.setUint32(r+4,u),o()}function k(_,u){u<24?l(_<<5|u):u<256?(l(_<<5|24),l(u)):u<65536?(l(_<<5|25),m(u)):u<4294967296?(l(_<<5|26),w(u)):(l(_<<5|27),c(u))}function h(_){var u;if(_===!1)return l(244);if(_===!0)return l(245);if(_===null)return l(246);if(_===void 0)return l(247);switch(typeof _){case"number":if(Math.floor(_)===_){if(0<=_&&_<=POW_2_53)return k(St,_);if(-POW_2_53<=_&&_<0)return k(At,-(_+1))}return l(251),g(_);case"string":var E=[];for(u=0;u<_.length;++u){var b=_.charCodeAt(u);b<128?E.push(b):b<2048?(E.push(192|b>>6),E.push(128|b&63)):b<55296?(E.push(224|b>>12),E.push(128|b>>6&63),E.push(128|b&63)):(b=(b&1023)<<10,b|=_.charCodeAt(++u)&1023,b+=65536,E.push(240|b>>18),E.push(128|b>>12&63),E.push(128|b>>6&63),E.push(128|b&63))}return k(Rt,E.length),s(E);default:var d;if(Array.isArray(_))for(d=_.length,k(Dt,d),u=0;u<d;++u)h(_[u]);else if(_ instanceof Uint8Array)k(Tt,_.length),s(_);else if(_ instanceof Map){d=_.size,k(qe,d);for(let[x,v]of _)h(x),h(v)}else{var p=Object.keys(_);for(d=p.length,k(qe,d),u=0;u<d;++u){var A=p[u];h(A),h(_[A])}}}}return h(i),t.slice(0,r)}static async verifyCWT(i,t){let[a,n,r,f]=V.decode(i),o=new Uint8Array(0);const g=["Signature1",a,o,r];let l=V.encode(g),s=!1;try{s=await yt.verify(t,f,l),console.log("VERIFIED:",s)}catch(m){console.log("ERROR:",m)}return s}static decode(i,t,a){var n=new DataView(i),r=0;typeof t!="function"&&(t=function(p){return p}),typeof a!="function"&&(a=function(){});function f(p,A){return r+=p,A}function o(p){return f(p,new Uint8Array(i,r,p))}function g(){var p=new ArrayBuffer(4),A=new DataView(p),x=w(),v=x&32768,y=x&31744,S=x&1023;if(y===31744)y=255<<10;else if(y!==0)y+=127-15<<10;else if(S!==0)return(v?-1:1)*S*POW_2_24;return A.setUint32(0,v<<16|y<<13|S<<13),A.getFloat32(0)}function l(){return f(4,n.getFloat32(r))}function s(){return f(8,n.getFloat64(r))}function m(){return f(1,n.getUint8(r))}function w(){return f(2,n.getUint16(r))}function c(){return f(4,n.getUint32(r))}function k(){return c()*POW_2_32+c()}function h(){return n.getUint8(r)!==255?!1:(r+=1,!0)}function _(p){if(p<24)return p;if(p===24)return m();if(p===25)return w();if(p===26)return c();if(p===27)return k();if(p===31)return-1;throw"Invalid length encoding"}function u(p){var A=m();if(A===255)return-1;var x=_(A&31);if(x<0||A>>5!==p)throw"Invalid indefinite length element";return x}function E(p,A){for(var x=0;x<A;++x){var v=m();v&128&&(v<224?(v=(v&31)<<6|m()&63,A-=1):v<240?(v=(v&15)<<12|(m()&63)<<6|m()&63,A-=2):(v=(v&15)<<18|(m()&63)<<12|(m()&63)<<6|m()&63,A-=3)),v<65536?p.push(v):(v-=65536,p.push(55296|v>>10),p.push(56320|v&1023))}}function b(){var p=m(),A=p>>5,x=p&31,v,y;if(A===an)switch(x){case 25:return g();case 26:return l();case 27:return s()}if(y=_(x),y<0&&(A<2||6<A))throw"Invalid length";switch(A){case St:return y;case At:return-1-y;case Tt:if(y<0){for(var S=[],T=0;(y=u(A))>=0;)T+=y,S.push(o(y));var M=new Uint8Array(T),P=0;for(v=0;v<S.length;++v)M.set(S[v],P),P+=S[v].length;return M}return o(y);case Rt:var O=[];if(y<0)for(;(y=u(A))>=0;)E(O,y);else E(O,y);return String.fromCharCode.apply(null,O);case Dt:var R;if(y<0)for(console.log("INDEFINITE LENGTH ARRAY"),R=[];!h();)R.push(b());else for(R=new Array(y),v=0;v<y;++v)R[v]=b();return R;case qe:var H=new Map;for(v=0;v<y||y<0&&!h();++v){var Z=b();H.set(Z,b())}return H;case It:return t(b(),y);case 7:switch(y){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return a(y)}}}var d=b();if(r!==i.byteLength)throw"Remaining bytes";return d}static async decodeCWT(i,t){var a=new DataView(i);function n(h,_){let u=h.slice(),E=V.decode(u.buffer),b=E.get(Pr);if(b===void 0)throw"Missing algorithm in protected headers";let d=zt.get(b);if(d===void 0)throw`Invalid algorithm specified: ${b}`;let p={};p.alg=d;let A=E.get(rn);if(A===void 0&&(A=_.get(rn)),A===void 0)throw"Missing kid in headers";let x="";for(let v=0;v<A.length;v++)x=x+String.fromCodePoint(A[v]);return x=window.btoa(x),p.kid=x,p}function r(h){const _=1,u=2,E=3,b=4,d=5,p=6,A=7,x=-260,v=1,y="v",S="t",T="r";h=h.slice();let M=V.decode(h.buffer);h={};for(let[H,Z]of M)switch(H){case _:h.iss=Z;break;case u:h.sub=Z;break;case E:h.aud=Z;break;case b:h.exp=Z;break;case d:h.nbf=Z;break;case p:h.iat=Z;break;case A:h.cti=Z;break}let P=M.get(x);if(P==null)throw"No hcert found";let O=P.get(v);if(O==null)throw"No EU COVID certificate found";try{h.version=O.get("ver"),h.foreName=O.get("nam").get("fn"),h.givenName=O.get("nam").get("gn"),h.fullName=h.foreName+", "+h.givenName,h.dateOfBirth=O.get("dob")}catch(H){throw`Error accessing required common fields: ${H}`}let R;if(O.get("v"))h.certType=y,R=O.get("v")[0];else if(O.get("r"))h.certType=T,R=O.get("r")[0];else if(O.get("t"))h.certType=S,R=O.get("t")[0];else throw"Invalid EU COVID certificate type";return h.certType===y?(h.diseaseTargeted=vs.get(R.get("tg"),"disease-agent-targeted"),h.vaccineProphylaxis=vs.get(R.get("vp"),"vaccine-prophylaxis"),h.medicinalProduct=vs.get(R.get("mp"),"vaccine-medicinal-product"),h.manufacturer=vs.get(R.get("ma"),"vaccine-mah-manf"),h.doseNumber=R.get("dn"),h.doseTotal=R.get("sd"),h.dateVaccination=R.get("dt"),h.country=vs.get(R.get("co"),"country-2-codes"),h.certificateIssuer=R.get("is"),h.uniqueIdentifier=R.get("ci")):h.certType===S?(h.diseaseTargeted=vs.get(R.get("tg"),"disease-agent-targeted"),h.typeTest=vs.get(R.get("tt"),"test-type"),h.testName=R.get("nm"),h.manufacturer=vs.get(R.get("ma"),"test-manf"),h.timeSample=R.get("sc"),h.testResult=vs.get(R.get("tr"),"test-result"),h.testingCentre=R.get("tc"),h.country=vs.get(R.get("co"),"country-2-codes"),h.certificateIssuer=R.get("is"),h.uniqueIdentifier=R.get("ci")):h.certType===T&&(h.diseaseTargeted=vs.get(R.get("tg"),"disease-agent-targeted"),h.datePositive=R.get("fr"),h.dateFrom=R.get("df"),h.dateUntil=R.get("du"),h.country=vs.get(R.get("co"),"country-2-codes"),h.certificateIssuer=R.get("is"),h.uniqueIdentifier=R.get("ci")),h}var f=a.getUint8(0),o=f>>5,g=f&31;if(o==It){if(g!=Br)throw new Error(`Not a COSE Single signature, tag: ${g}`);i=i.slice(1)}let[l,s,m,w]=V.decode(i),c=n(l,s),k=!1;if(t){let h=c.kid,_=await getTrustedKey(h);if(_!==void 0)if(_.list==="EU_PRO"){console.log(_);let u=await yt.fromJWK(_.publicKey);k=await V.verifyCWT(i,u)}else if(_.list==="UK_PRO"){let u=await yt.fromSPKI(_.publicKey);k=await V.verifyCWT(i,u)}else _.list==="EU_PREPRODUCTION"&&(k="PRE")}return m=r(m),console.log("Payload:",m),[c,m,w,k]}static async decodeHC1QR(i,t=!1){if(!i.startsWith("HC1:"))throw new Error("Certificate does not start with 'HC1:'");i=i.slice(4);let a=Hr(i);a=new Uint8Array(a);let n=Fr(a),[r,f,o,g]=await V.decodeCWT(n.buffer,t);return[r,f,o,g]}static displayMB(i){var t=i>>5,a=i&31,n=a;switch(t===an&&console.log("FLOAT"),t){case St:console.log(`Integer ${n}`);return;case At:console.log(`Negative Integer ${-1-n}`);return;case Tt:return console.log(`Bstr ${n}`),`Bstr ${n}`;case Rt:console.log(`String ${n}`);return;case Dt:console.log(`Array ${n}`);return;case qe:console.log(`Map ${n}`);return;case It:console.log(`Tag ${n}`);return;case 7:switch(n){case 20:console.log("FALSE");return;case 21:console.log("TRUE");return;case 22:console.log("NULL");return;case 23:console.log("UNDEFINED");return;default:console.log("Simple Value");return}}}};let we=V;Ne(we,"POW_2_24",5960464477539063e-23),Ne(we,"POW_2_32",4294967296),Ne(we,"POW_2_53",Number.MAX_SAFE_INTEGER);class Kr{constructor(){}static async renderSummary(i,t){let n=(await we.decodeHC1QR(t.encoded,!1))[1];console.log("renderSummary",t);let r="Unrecognized",f="Unrecognized";return n.certType=="v"?(r="EU COVID VACCINATION",f=n.dateVaccination):n.certType=="t"?(r="EU COVID TEST",f=n.timeSample):n.certType=="r"&&(r="EU COVID RECOVERY",f=n.dateFrom),`
        <div class="card my-3 shadow">
            <a onclick="displayCredentialFromKey('${i}')">
            <div class="card-body">
                <h5 class="card-title">${n.fullName}</h5>
                <p>${r}</p>
                <p>${f}</p>
            </div>
            </a>
        </div>
        `}}export{we as CWT,Kr as HCERT};
